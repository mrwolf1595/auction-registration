# ูุธุงู ุชูููุฏ PDF ุงููุญุฏุซ - ุฏููู ุดุงูู

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุญุฏูุซ ูุธุงู ุชูููุฏ PDF ููุฏุนู ุงููุบุฉ ุงูุนุฑุจูุฉ ุจุดูู ูุงูู ูุน ุฅุธูุงุฑ ุงูุชูููุนุงุช ูุงูููุฌู ูุงูุฎุชู ุจุดูู ุตุญูุญ.

## ููู ูุนูู ุงููุธุงู

### 1. ุงููุณุชุฎุฏู ูููุฃ ุงููููุฐุฌ
- ูููุฃ ุงููุณุชุฎุฏู ุงููููุฐุฌ ูู `src/app/register/page.tsx`
- ูุชู ุญูุธ ุงูุชูููุน (ุฅูุง ุชูููุน ุฑููู ุฃู ุงุณู ูุทุจูุน) ูู `formData.signature`

### 2. ุนูุฏ ุงูุถุบุท ุนูู "ุชุณุฌูู ุงููุดุงุฑูุฉ"
```typescript
const onSubmit = async (data: ValidatedFormData) => {
  // 1. ุงูุชุญูู ูู ูุฌูุฏ ุงูุชูููุน
  if (!signature) {
    alert('ูุฑุฌู ุงูุชูููุน ุนูู ุงููููุฐุฌ');
    return;
  }
  
  // 2. ุญูุธ ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  const result = await saveRegistration(registrationData);
  
  // 3. ุชุนููู ุฑูู ุงููุถุฑุจ ููุชุญ SubmitFlowModal
  setBidderNumber(result.bidderNumber);
  setSubmittedFormData(pdfFormData);
  setIsSubmitFlowOpen(true);
}
```

### 3. ุชูููุฏ PDF

#### ุงูุฎุทูุฉ 1: ุฅูุดุงุก ุตูุฑุฉ PNG ุจุงูุจูุงูุงุช ุงูุนุฑุจูุฉ
```typescript
// ูู robustPdfGenerator.ts
export async function generateReceiptPNG(formData: ValidatedFormData, bidderNumber?: number) {
  // 1. ุฅูุดุงุก ุนูุตุฑ HTML ูุคูุช ุจุงูุจูุงูุงุช
  const tempElement = document.createElement('div');
  
  // 2. ุฅุถุงูุฉ ุงูููุฌู ูู ุงูุฃุนูู
  <img src="/Asset%202@2x.png" />
  
  // 3. ุฅุถุงูุฉ ุงูุจูุงูุงุช ุจุงูุนุฑุจูุฉ
  - ุงุณู ุงููุฒุงูุฏ
  - ุฑูู ุงููููุฉ
  - ุฑูู ุงูุฌูุงู
  - ุงูุจูู ุงููุตุฏุฑ
  - ุชูุงุตูู ุงูุดููุงุช
  
  // 4. ุฅุถุงูุฉ ุงูุชูููุน
  if (formData.signature && formData.signature.startsWith('data:image')) {
    <img src="${formData.signature}" />
  }
  
  // 5. ุฅุถุงูุฉ ุงูุฎุชู ูู ุฃุณูู ุงููุณุงุฑ
  <img src="/company-seal.png" style="position: absolute; bottom: 20px; left: 20px;" />
  
  // 6. ุงุณุชุฎุฏุงู html2canvas ูุฅูุดุงุก ุตูุฑุฉ PNG
  const canvas = await html2canvas(tempElement, {
    scale: 2, // ุฌูุฏุฉ ุนุงููุฉ
    useCORS: true,
    backgroundColor: '#ffffff'
  });
  
  // 7. ุชุญููู Canvas ุฅูู PNG blob
  const pngBlob = await canvas.toBlob();
  
  return pngBlob;
}
```

#### ุงูุฎุทูุฉ 2: ุชุญููู PNG ุฅูู PDF
```typescript
export async function convertPNGToPDF(pngBlob: Blob) {
  // 1. ุงุณุชูุฑุงุฏ jsPDF
  const { jsPDF } = await import('jspdf');
  
  // 2. ุฅูุดุงุก ูุณุชูุฏ PDF
  const doc = new jsPDF('p', 'mm', 'a4');
  
  // 3. ุชุญููู PNG blob ุฅูู data URL
  const pngDataURL = await blobToDataURL(pngBlob);
  
  // 4. ุฅุถุงูุฉ ุงูุตูุฑุฉ ุฅูู PDF (ุชููุฃ ุงูุตูุญุฉ ุจุงููุงูู)
  doc.addImage(pngDataURL, 'PNG', 0, 0, 210, 297);
  
  // 5. ุชูููุฏ PDF blob
  const pdfBlob = doc.output('blob');
  
  return pdfBlob;
}
```

### 4. ุชุญููู PDF
```typescript
// ูู useSubmitFlow.ts
if (!isEmployeePage && declarationResult.blob) {
  const url = URL.createObjectURL(declarationResult.blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `declaration_${formData.bidderName}_${Date.now()}.pdf`;
  a.click();
}
```

## ุงููููุงุช ุงููุญุฏุซุฉ

### 1. `src/lib/robustPdfGenerator.ts`
- โ `generateReceiptPNG()` - ูููุฏ ุตูุฑุฉ PNG ููุฅูุตุงู ุจุงูุนุฑุจูุฉ ูุน ุงูุชูููุน ูุงูููุฌู ูุงูุฎุชู
- โ `generateDeclarationPNG()` - ูููุฏ ุตูุฑุฉ PNG ููุฅูุฑุงุฑ ุจุงูุนุฑุจูุฉ ูุน ุงูุชูููุน ูุงูููุฌู ูุงูุฎุชู
- โ `convertPNGToPDF()` - ูุญูู ุตูุฑุฉ PNG ุฅูู PDF
- โ `generateRobustReceiptPDF()` - ุฏุงูุฉ ุฑุฆูุณูุฉ ูุชูููุฏ PDF ุงูุฅูุตุงู
- โ `generateRobustDeclarationPDF()` - ุฏุงูุฉ ุฑุฆูุณูุฉ ูุชูููุฏ PDF ุงูุฅูุฑุงุฑ

### 2. `src/hooks/useSubmitFlow.ts`
- โ ุชุญุฏูุซ ูุชูุฑูุฑ `bidderNumber` ุฅูู ุฏูุงู ุชูููุฏ PDF
- โ ุชุญููู PDF ุชููุงุฆูุงู ุจุนุฏ ุงูุชูููุฏ

### 3. `src/app/register/page.tsx`
- โ ูุฏุนู ุงูุชูููุน ุงูุฑููู ูุงูุงุณู ุงููุทุจูุน
- โ ูุญูุธ ุงูุชูููุน ูู `formData.signature`

### 4. `src/components/SignatureCanvas.tsx`
- โ ูููุฏ ุตูุฑุฉ ุงูุชูููุน ุจุตูุบุฉ `data:image/png`
- โ ูุชู ุญูุธ ุงูุชูููุน ูู ุญุงูุฉ `signature`

## ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ

### 1. ุฏุนู ูุงูู ููุบุฉ ุงูุนุฑุจูุฉ
- โ ุงููุต ุงูุนุฑุจู ูุธูุฑ ุจุดูู ุตุญูุญ ูู PDF
- โ ุงุณุชุฎุฏุงู `html2canvas` ุจุฏูุงู ูู `jsPDF` ูุจุงุดุฑุฉ
- โ ุงุณุชุฎุฏุงู ุฎุท `Arial` ุงูุฐู ูุฏุนู ุงูุนุฑุจูุฉ

### 2. ุฅุธูุงุฑ ุงูุชูููุน
- โ ุงูุชูููุน ุงูุฑููู ูุธูุฑ ูู PDF
- โ ุงูุงุณู ุงููุทุจูุน ูุธูุฑ ูู ุตูุฏูู ูุฎุตุต
- โ ุงูุชูููุน ูุชู ุญูุธู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 3. ุงูููุฌู ูุงูุฎุชู
- โ ุงูููุฌู ูุธูุฑ ูู ุงูุฃุนูู
- โ ุงูุฎุชู ูุธูุฑ ูู ุฃุณูู ุงููุณุงุฑ
- โ ุงุณุชุฎุฏุงู `crossorigin="anonymous"` ูุชุญููู ุงูุตูุฑ

### 4. ุฑูู ุงููุถุฑุจ
- โ ูุชู ุชูููุฏ ุฑูู ูุถุฑุจ ุชููุงุฆูุงู
- โ ูุธูุฑ ูู PDF
- โ ูุชู ุญูุธู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุงููุธุงู ุงููุงูู:
1. ุงูุชุญ `http://localhost:3000/register`
2. ุงููุฃ ุงููููุฐุฌ ุจุงูุจูุงูุงุช
3. ููุน ุงูุชูููุน ุฃู ุฃุฏุฎู ุงุณูู ุงููุทุจูุน
4. ุงุถุบุท ุนูู "ุชุณุฌูู ุงููุดุงุฑูุฉ"
5. ุงูุชุธุฑ ุชูููุฏ PDF
6. ุชุญูู ูู:
   - โ ุงููุต ุงูุนุฑุจู ูุธูุฑ ุจุดูู ุตุญูุญ
   - โ ุงูุชูููุน ูุธูุฑ ูู PDF
   - โ ุงูููุฌู ูุธูุฑ ูู ุงูุฃุนูู
   - โ ุงูุฎุชู ูุธูุฑ ูู ุฃุณูู ุงููุณุงุฑ
   - โ ุฑูู ุงููุถุฑุจ ูุธูุฑ ูู PDF

## ุงููุดุงูู ุงูุชู ุชู ุญููุง

### 1. ุงููุต ุงูุนุฑุจู ูุธูุฑ ูุฃุญุฑู ุบุฑูุจุฉ
- โ **ุงููุดููุฉ**: ุงุณุชุฎุฏุงู `jsPDF` ูุจุงุดุฑุฉ ูุง ูุฏุนู ุงูุนุฑุจูุฉ ุฌูุฏุงู
- โ **ุงูุญู**: ุงุณุชุฎุฏุงู `html2canvas` ูุฅูุดุงุก ุตูุฑุฉ PNG ุซู ุชุญููููุง ุฅูู PDF

### 2. ุงูุชูููุน ูุง ูุธูุฑ ูู PDF
- โ **ุงููุดููุฉ**: `formData.signature` ูู ููู ูุชู ุชูุฑูุฑู ุจุดูู ุตุญูุญ
- โ **ุงูุญู**: ุชูุฑูุฑ `formData.signature` ูุน ุงูุจูุงูุงุช ูุฅุถุงูุชู ูู HTML

### 3. ุงูููุฌู ูุงูุฎุชู ูุง ูุธูุฑุงู
- โ **ุงููุดููุฉ**: ูุณุงุฑุงุช ุงูุตูุฑ ุบูุฑ ุตุญูุญุฉ ุฃู ูุง ูุชู ุชุญููููุง
- โ **ุงูุญู**: ุงุณุชุฎุฏุงู `crossorigin="anonymous"` ูุงูุงูุชุธุงุฑ ูุชุญููู ุงูุตูุฑ

### 4. ุฑูู ุงููุถุฑุจ ูุง ูุธูุฑ
- โ **ุงููุดููุฉ**: `bidderNumber` ูู ููู ูุชู ุชูุฑูุฑู ุฅูู ุฏูุงู ุชูููุฏ PDF
- โ **ุงูุญู**: ุชุญุฏูุซ ุฌููุน ุงูุฏูุงู ููุจูู ูุชูุฑูุฑ `bidderNumber`

## ุงููููุงุช ุบูุฑ ุงููุณุชุฎุฏูุฉ

ูุฐู ุงููููุงุช ููุฌูุฏุฉ ููู ูู ูุนุฏ ูุชู ุงุณุชุฎุฏุงููุง:

- โ `src/lib/simplePngToPdf.ts` - ุงุณุชุฎุฏู `robustPdfGenerator.ts` ุจุฏูุงู ููู
- โ `src/lib/pdfGenerator.ts` - ุงุณุชุฎุฏู `robustPdfGenerator.ts` ุจุฏูุงู ููู
- โ `src/lib/enhancedPdfGenerator.ts` - ุงุณุชุฎุฏู `robustPdfGenerator.ts` ุจุฏูุงู ููู

## ููุงุญุธุงุช ูููุฉ

1. **ุฌูุฏุฉ ุงูุตูุฑุฉ**: ุงุณุชุฎุฏุงู `scale: 2` ูู `html2canvas` ูุฌูุฏุฉ ุนุงููุฉ
2. **ุญุฌู ุงูููู**: ุงุณุชุฎุฏุงู PNG ุจุฏูุงู ูู JPEG ูุฌูุฏุฉ ุฃูุถู
3. **ุงูุชูุงูู**: ุงููุธุงู ูุนูู ุนูู ุฌููุน ุงููุชุตูุญุงุช ุงูุญุฏูุซุฉ
4. **ุงูุฃูุงู**: ุฌููุน ุงูุจูุงูุงุช ุชูุนุงูุฌ ูู ุงููุชุตูุญ ููุท

## ุงูุฏุนู ุงูููู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุฃูุฏ ูู ูุฌูุฏ ุงูุตูุฑ ูู ุงููุณุงุฑุงุช ุงูุตุญูุญุฉ:
   - `/public/Asset 2@2x.png` (ุงูููุฌู)
   - `/public/company-seal.png` (ุงูุฎุชู)
2. ุชุฃูุฏ ูู ุชุซุจูุช ุฌููุน ุงูููุชุจุงุช ุงููุทููุจุฉ:
   ```bash
   npm install html2canvas jspdf
   ```
3. ุงูุชุญ Console ูู ุงููุชุตูุญ ูุฑุคูุฉ ุฃู ุฃุฎุทุงุก

## ุงูุฎูุงุตุฉ

ุงููุธุงู ุงูุขู ูุนูู ุจุดูู ูุงูู ููุฏุนู:
- โ ุงููุบุฉ ุงูุนุฑุจูุฉ
- โ ุงูุชูููุน ุงูุฑููู ูุงูุงุณู ุงููุทุจูุน
- โ ุงูููุฌู ูุงูุฎุชู
- โ ุฑูู ุงููุถุฑุจ
- โ ุชุญููู PDF ุชููุงุฆูุงู

**ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู! ๐**

